<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Chapter 3. Database administration</title><meta name="generator" content="DocBook XSL Stylesheets V1.75.1"><link rel="home" href="index.html" title="EyeDB Administration Guide"><link rel="up" href="index.html" title="EyeDB Administration Guide"><link rel="prev" href="ch02s05.html" title="Server network access file"><link rel="next" href="ch03s02.html" title="Renaming, copying and moving a database"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter 3. Database administration</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch02s05.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ch03s02.html">Next</a></td></tr></table><hr></div><div class="chapter" title="Chapter 3. Database administration"><div class="titlepage"><div><div><h2 class="title"><a name="database"></a>Chapter 3. Database administration</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="ch03.html#id551388">Creating and deleting a database</a></span></dt><dd><dl><dt><span class="section"><a href="ch03.html#id550060">Creating a database</a></span></dt><dt><span class="section"><a href="ch03.html#id544187">Deleting a database</a></span></dt><dt><span class="section"><a href="ch03.html#id534799">Listing databases</a></span></dt><dt><span class="section"><a href="ch03.html#id570199">Setting database default access rights</a></span></dt></dl></dd><dt><span class="section"><a href="ch03s02.html">Renaming, copying and moving a database</a></span></dt><dd><dl><dt><span class="section"><a href="ch03s02.html#id570424">Renaming a database</a></span></dt><dt><span class="section"><a href="ch03s02.html#id570610">Copying a database</a></span></dt><dt><span class="section"><a href="ch03s02.html#id570838">Moving a database</a></span></dt></dl></dd><dt><span class="section"><a href="ch03s03.html">Exporting and importing a database</a></span></dt><dd><dl><dt><span class="section"><a href="ch03s03.html#id571054">Exporting a database</a></span></dt><dt><span class="section"><a href="ch03s03.html#id571188">Importing a database</a></span></dt></dl></dd></dl></div><p>
      This chapter covers the database administration commands used for:
      </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>creating and deleting databases</p></li><li class="listitem"><p>getting information on databases</p></li><li class="listitem"><p>moving, copying, renaming databases</p></li><li class="listitem"><p>importing and exporting databases</p></li></ul></div><p>
    </p><p>
      All these operations are performed using the <span class="command"><strong>eyedbadmin</strong></span> command and its <span class="command"><strong>database</strong></span> topic.
    </p><div class="section" title="Creating and deleting a database"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id551388"></a>Creating and deleting a database</h2></div></div></div><div class="section" title="Creating a database"><div class="titlepage"><div><div><h3 class="title"><a name="id550060"></a>Creating a database</h3></div></div></div><p>
	  Creating a database is done using the <span class="command"><strong>eyedbadmin</strong></span> command:
	  </p><div class="cmdsynopsis"><p><code class="command">eyedbadmin</code> <br><code class="command">database create</code>  [options...]  <em class="replaceable"><code>database</code></em> </p></div><p>
	</p><p>
	  Options are:
	  </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
		</p><div class="cmdsynopsis"><p> --dbfile=<em class="replaceable"><code>file</code></em> </p></div><p>
		specifies the database file (a file, usually with <code class="filename">.dbs</code> extension, that stores the database structure.
	      </p></li><li class="listitem"><p>
		</p><div class="cmdsynopsis"><p> --filedir=<em class="replaceable"><code>directory</code></em> </p></div><p> 
		specifies the directory that will contains the database data files
	      </p></li><li class="listitem"><p>
		</p><div class="cmdsynopsis"><p> --max-object-count=<em class="replaceable"><code>count</code></em> </p></div><p>
		specifies the maximum number of objects that can be store in the database
	      </p></li></ul></div><p>
	</p><p>
	  <a class="xref" href="ch03.html#eyedbadmin-database-create" title="Example 3.1. eyedbadmin database create">Example 3.1, “<span class="command">eyedbadmin</span> database create”</a> shows several examples of database creation.
	</p><div class="example"><a name="eyedbadmin-database-create"></a><p class="title"><b>Example 3.1. <span class="command">eyedbadmin</span> database create</b></p><div class="example-contents"><pre class="screen">
# create database 'test1'
<strong class="userinput"><code>eyedbadmin database create test1</code></strong>
# create database 'test2' giving the database file
<strong class="userinput"><code>eyedbadmin database create --dbfile=/var/tmp/test2.dbs test2</code></strong>
<strong class="userinput"><code>ls -l /var/tmp/test2.dbs</code></strong>
-rw------- 1 francois francois 250696 2009-03-13 11:55 /var/tmp/test2.dbs
# create database 'test3' giving the database files directory
<strong class="userinput"><code>mkdir /var/tmp/test3</code></strong>
<strong class="userinput"><code>eyedbadmin database create --filedir=/var/tmp/test3 test3</code></strong>
<strong class="userinput"><code>ls -l /var/tmp/test3</code></strong>
total 1504
-rw------- 1 francois francois  8471424 2009-03-13 11:57 test3.dat
-rw------- 1 francois francois   250696 2009-03-13 11:57 test3.dbs
-rw------- 1 francois francois    70000 2009-03-13 11:57 test3.dmp
-rw------- 1 francois francois        0 2009-03-13 11:57 test3.lck
-rw------- 1 francois francois    61440 2009-03-13 11:57 test3.omp
-rw------- 1 francois francois 67108864 2009-03-13 11:57 test3.shm
	  </pre></div></div><br class="example-break"><p>
	</p></div><div class="section" title="Deleting a database"><div class="titlepage"><div><div><h3 class="title"><a name="id544187"></a>Deleting a database</h3></div></div></div><p>
	  Deleting a database is done using the <span class="command"><strong>eyedbadmin</strong></span> command:
	  </p><div class="cmdsynopsis"><p><code class="command">eyedbadmin</code>   database delete   <em class="replaceable"><code>database</code></em>... </p></div><p>
	</p><p>
	  This command has no options (except the <span class="command"><strong>eyedbadmin</strong></span> command standard options).
	</p><div class="example"><a name="eyedbadmin-database-delete"></a><p class="title"><b>Example 3.2. <span class="command">eyedbadmin</span> database delete</b></p><div class="example-contents"><pre class="screen">
# delete database 'test1'
<strong class="userinput"><code>eyedbadmin database delete test1</code></strong>
	  </pre></div></div><br class="example-break"></div><div class="section" title="Listing databases"><div class="titlepage"><div><div><h3 class="title"><a name="id534799"></a>Listing databases</h3></div></div></div><p>
	  Obtaining a list of existing databases or obtaining information on a specific database is done using the <span class="command"><strong>eyedbadmin</strong></span> command:
	  </p><div class="cmdsynopsis"><p><code class="command">eyedbadmin</code> <br><code class="command">database list</code>  [options...]  [~]<em class="replaceable"><code>database</code></em>... </p></div><p>
	</p><p>
	  Options are:
	  </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
		</p><div class="cmdsynopsis"><p> --dbname </p></div><p>
		lists database names
	      </p></li><li class="listitem"><p>
		</p><div class="cmdsynopsis"><p> --dbid </p></div><p>
		lists database identifier
	      </p></li><li class="listitem"><p>
		</p><div class="cmdsynopsis"><p> --dbfile </p></div><p>
		lists database file
	      </p></li><li class="listitem"><p>
		</p><div class="cmdsynopsis"><p> --max-object-count </p></div><p>
		lists database max object count
	      </p></li><li class="listitem"><p>
		</p><div class="cmdsynopsis"><p> --datafiles </p></div><p>
		lists database datafiles
	      </p></li><li class="listitem"><p>
		</p><div class="cmdsynopsis"><p> --defaccess </p></div><p>
		lists database default access
	      </p></li><li class="listitem"><p>
		</p><div class="cmdsynopsis"><p> --useraccess </p></div><p>
		lists user database accesses
	      </p></li><li class="listitem"><p>
		</p><div class="cmdsynopsis"><p> --stats </p></div><p>
		lists database statistics
	      </p></li><li class="listitem"><p>
		</p><div class="cmdsynopsis"><p> --all </p></div><p>
		lists all database info
	      </p></li></ul></div><p>
	</p><p>
	  Command arguments are:
	  </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
		</p><div class="cmdsynopsis"><p> [~]<em class="replaceable"><code>database</code></em>... </p></div><p>
		database(s) to list (~ means regular expression)
	      </p></li></ul></div><p>
	</p><p>
	  <a class="xref" href="ch03.html#eyedbadmin-database-list" title="Example 3.3. eyedbadmin database list">Example 3.3, “<span class="command">eyedbadmin</span> database list”</a> shows several examples of database listing.
	</p><div class="example"><a name="eyedbadmin-database-list"></a><p class="title"><b>Example 3.3. <span class="command">eyedbadmin</span> database list</b></p><div class="example-contents"><pre class="screen">
# list all databases
<strong class="userinput"><code>eyedbadmin database list</code></strong>
Database Name
  test
Database Identifier
  2
Database File
  /home/francois/projects/eyedb/install/var/lib/eyedb/db/test.dbs
Max Object Count
  10000000
Datafiles
  Datafile #0
    Name      DEFAULT
    Dataspace #0
    File      test.dat
    Maxsize   ~2048Mb
    Slotsize  16b
    Server Access read/write
Default Access
  NO_DBACCESS_MODE
Database Access
  User Name  francois
  Access Mode ADMIN_DBACCESS_MODE
Database Name
  EYEDBDBM
....
### output truncated for readability
# list only database names
<strong class="userinput"><code>eyedbadmin database list --dbname</code></strong>
test
EYEDBDBM
test3
test2
# list non existing database
<strong class="userinput"><code>eyedbadmin database list --dbname foo</code></strong>
Database 'foo' not found
# list statistics for a given database
<strong class="userinput"><code>eyedbadmin database list --stats test</code></strong>
Statistics
  Maximum Object Number 10000000
  Object Number         2574
  Maximum Slot Count    134217728
  Busy Slot Count       532202
  Maximum Size          2147483648b, ~2097152Kb, ~2048Mb, ~2Gb
  Busy Slot Size        8515232b, ~8315Kb, ~8Mb
  Disk Size Used        76007288b, ~74225Kb, ~72Mb
  Disk Block Size Used  10452992b, ~10208Kb, ~10Mb
  Used                  0.40%
# list database default access right
<strong class="userinput"><code>eyedbadmin database list --defaccess test</code></strong>
NO_DBACCESS_MODE
# list with regular expression (note shell quoting)
<strong class="userinput"><code>eyedbadmin database list --dbname '~test*'</code></strong>
test
test3
test2
# list with another regular expression (note shell quoting)
<strong class="userinput"><code>eyedbadmin database list --dbname --dbfile '~test[0-9]'</code></strong>
test3
/var/tmp/test3/test3.dbs
test2
/var/tmp/test2.dbs
	  </pre></div></div><br class="example-break"></div><div class="section" title="Setting database default access rights"><div class="titlepage"><div><div><h3 class="title"><a name="id570199"></a>Setting database default access rights</h3></div></div></div><p>
	  Database access rights are defined at two levels:
	  </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>default database access, applying for all EyeDB users</p></li><li class="listitem"><p>per user database access, applying only for specified user</p></li></ul></div><p>
	</p><p>
	  Setting default access right is done use the <span class="command"><strong>eyedbadmin</strong></span> command:
	  </p><div class="cmdsynopsis"><p><code class="command">eyedbadmin</code>   database defaccess   <em class="replaceable"><code>database</code></em>   <em class="replaceable"><code>mode</code></em> </p></div><p>
	</p><p>
	  Allowed values for <em class="replaceable"><code>mode</code></em> are:
	  </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p><span class="command"><strong>r</strong></span>: read-only</p></li><li class="listitem"><p><span class="command"><strong>rw</strong></span>: read/write</p></li><li class="listitem"><p><span class="command"><strong>rx</strong></span>: read/execute</p></li><li class="listitem"><p><span class="command"><strong>rwx</strong></span>: read/write/execute</p></li><li class="listitem"><p><span class="command"><strong>admin</strong></span>: administrate</p></li><li class="listitem"><p><span class="command"><strong>no</strong></span>: access forbiden</p></li></ul></div><p>
	</p><div class="example"><a name="eyedbadmin-database-defaccess"></a><p class="title"><b>Example 3.4. <span class="command">eyedbadmin</span> database defaccess</b></p><div class="example-contents"><pre class="screen">
# list database default access right
<strong class="userinput"><code>eyedbadmin database list --defaccess test</code></strong>
NO_DBACCESS_MODE
# set default access right to read-only
<strong class="userinput"><code>eyedbadmin database defaccess test r</code></strong>
# list database default access right
<strong class="userinput"><code>eyedbadmin database list --defaccess test</code></strong>
READ_DBACCESS_MODE
# set default access right to read/write
<strong class="userinput"><code>eyedbadmin database defaccess test rw</code></strong>
# list database default access right
<strong class="userinput"><code>eyedbadmin database list --defaccess test</code></strong>
READ_WRITE_DBACCESS_MODE
	  </pre></div></div><br class="example-break"><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>Only an EyeDB user that has the <span class="command"><strong>admin</strong></span> database access for a given database can set a default database access for this database. The user that has created the database has automatically the <span class="command"><strong>admin</strong></span> database access.
	  </p></div></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch02s05.html">Prev</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="ch03s02.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Server network access file </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Renaming, copying and moving a database</td></tr></table></div></body></html>
